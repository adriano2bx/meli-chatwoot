Manual de Implantação: Integração Mercado Livre & ChatwootVersão 2.01. IntroduçãoEste documento detalha o processo completo para implantar a aplicação de integração entre o Mercado Livre e uma instância auto-hospedada (self-hosted) do Chatwoot. A aplicação, desenvolvida em Python e empacotada com Docker, automatiza a comunicação com clientes, centralizando perguntas de anúncios e mensagens pós-venda em um único painel.A integração é bidirecional, permitindo não apenas receber mensagens e anexos do Mercado Livre no Chatwoot, mas também responder diretamente pelo Chatwoot, com as respostas e arquivos sendo enviados de volta ao Mercado Livre.Tecnologias Utilizadas:Backend: PythonServidor Web (Webhook): Flask + GunicornContainerização: DockerGerenciador de Processos: SupervisorPlataforma de Implantação: EasyPanel (ou qualquer VPS com suporte a Docker)2. Pré-requisitosAntes de iniciar, garanta que você possui:✅ Acesso de Administrador a uma instância auto-hospedada do Chatwoot.✅ Uma conta de vendedor no Mercado Livre.✅ Uma VPS (Servidor Virtual Privado) com Docker e EasyPanel (ou um painel similar) instalado.✅ Um domínio ou subdomínio apontado para o IP da sua VPS (ex: meli-chat.seusite.com.br).✅ Uma conta no GitHub (ou GitLab/Bitbucket) para hospedar o código.✅ Ferramentas locais: Git, Python 3.10+ e uma ferramenta de API como o Postman.3. Passo a Passo da ImplantaçãoEtapa 1: Configuração do Projeto LocalObtenha o Código: Clone o repositório contendo todos os arquivos da aplicação para a sua máquina local.Crie o Repositório Git: Envie este código para um novo repositório privado na sua conta do GitHub.Verifique o .gitignore: Certifique-se de que o arquivo .gitignore está presente para evitar o envio de arquivos sensíveis (.env, meli_tokens.db, etc.) para o repositório.Etapa 2: Configuração da Aplicação no Mercado LivreCrie a Aplicação:Acesse o Portal de Desenvolvedores do Mercado Livre.Vá para "Suas aplicações" e clique em "Criar nova aplicação".Preencha as Informações:Nome: Dê um nome claro (ex: Integracao Chatwoot - Minha Loja).URI de redirect: Insira a URL principal da sua aplicação (o domínio que você apontou para a VPS). Ex: https://meli-chat.seusite.com.br.Defina as Permissões (Scopes):Na tela de configuração, revise as permissões e habilite as seguintes:offline_access: (Obrigatório) Permite que a aplicação renove o token de acesso automaticamente.read: Essencial para ler perguntas, pedidos, itens e mensagens.write: Essencial para responder perguntas e enviar mensagens.Anote as Credenciais:Na página de detalhes da sua aplicação, copie e guarde em um local seguro o App ID e a Chave secreta (Secret Key).Etapa 3: Configuração no ChatwootCrie as Caixas de Entrada (Inboxes):No painel do Chatwoot, vá em Configurações > Caixas de Entrada > Adicionar caixa de entrada.Selecione o canal "API".Crie a primeira caixa:Nome do canal: Mercado Livre - PerguntasWebhook URL: https://seu-dominio/webhook (use seu domínio real)Crie a segunda caixa:Nome do canal: Mercado Livre - VendasWebhook URL: https://seu-dominio/webhook (use a mesma URL)Anote os IDs: Para cada caixa criada, acesse suas configurações e copie o número de ID que aparece no final da URL do navegador.Crie o Webhook:Vá em Configurações > Webhooks > Adicionar novo Webhook.Webhook URL: https://seu-dominio/webhook (a mesma URL novamente).Assinaturas: Marque apenas a caixa message_created.Anote a Chave Secreta: Após criar, o Chatwoot exibirá a HMAC Secret Key. Copie e guarde-a.Obtenha o Token de Acesso:Clique no seu ícone de perfil (canto inferior esquerdo) > Perfil.Copie o seu Token de Acesso.Etapa 4: Autorização Inicial e Geração dos TokensEste passo manual é feito uma única vez para obter as credenciais que a aplicação usará para se auto-renovar.Construa a URL de Autorização:Use o modelo: https://auth.mercadolibre.com/authorization?response_type=code&client_id=SEU_APP_ID&redirect_uri=SUA_URL_DE_REDIRECTSubstitua SEU_APP_ID e SUA_URL_DE_REDIRECT pelos seus valores.Obtenha o Código de Autorização:Cole a URL construída no seu navegador.Faça login com sua conta de vendedor do Mercado Livre e autorize a aplicação.Você será redirecionado para a sua URL. Na barra de endereços, copie o código que começa com TG-.Troque o Código pelos Tokens:Abra o Postman.Crie uma requisição POST para https://api.mercadolibre.com/oauth/token.Na aba Body (x-www-form-urlencoded), preencha os seguintes campos:grant_type: authorization_codeclient_id: Seu App ID do MELI.client_secret: Sua Chave Secreta do MELI.code: O código TG-... que você copiou.redirect_uri: Sua URI de redirect.Envie a requisição.Salve os Tokens Finais:Na resposta JSON, copie os valores de access_token e refresh_token.Etapa 5: Implantação no EasyPanelCrie o Projeto:No EasyPanel, crie um novo serviço/projeto.Escolha a opção de implantar a partir de um repositório Git e conecte-o ao seu repositório do GitHub.Configure o Build:Selecione a opção para usar o Dockerfile encontrado na raiz do projeto.Informe a porta exposta como 5000.Configure as Variáveis de Ambiente:Esta é a etapa mais importante. Na seção "Environment Variables", adicione todas as chaves do arquivo .env.example e preencha com os valores que você coletou nos passos anteriores.Verifique cada chave e valor cuidadosamente.Configure o Domínio:Associe seu domínio público (ex: meli-chat.seusite.com.br) ao serviço. O EasyPanel cuidará do roteamento e do SSL.Faça o Deploy:Clique em "Deploy". O EasyPanel irá construir a imagem Docker e iniciar o contêiner com seus dois processos (poller e webhook) rodando internamente.Etapa 6: Verificação FinalMonitore os Logs: Na interface do EasyPanel, abra a visualização de logs da sua aplicação. Você deve ver mensagens indicando que o "Poller" e o servidor "Gunicorn" foram iniciados.Teste o Fluxo de Entrada: Envie uma pergunta em um anúncio do Mercado Livre. Dentro de 2-3 minutos, ela deve aparecer na caixa de entrada correta no Chatwoot, com os detalhes do produto.Teste o Fluxo de Saída: Responda a essa conversa diretamente pelo Chatwoot. A resposta deve aparecer no Mercado Livre.Teste os Anexos: Envie e receba uma imagem no chat pós-venda para confirmar que o suporte a arquivos está funcionando.Se todos os testes passarem, sua integração está 100% operacional. Parabéns!
